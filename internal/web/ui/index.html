<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TradeBot — Web App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  html,body{margin:0;padding:0;height:100%;font-family:Inter,system-ui,sans-serif;background:#0b0f17;color:#e6edf3}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  .card{background:#111826;border:1px solid #1f2837;border-radius:12px;padding:16px;margin-bottom:12px}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .muted{opacity:.7}
  .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
  button{background:#1f6feb;border:0;border-radius:8px;padding:10px 14px;color:#fff;cursor:pointer}
  input,select{background:#0b0f17;border:1px solid #1f2837;border-radius:8px;padding:8px 10px;color:#e6edf3}
  #chart{height:360px}
  .grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}
  .col2{grid-column:span 2}
  .col3{grid-column:span 3}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="row" style="justify-content:space-between">
        <div>
          <div style="font-weight:600;font-size:18px">Telegram Web App connected</div>
          <div id="who" class="muted">…</div>
        </div>
        <div class="row">
          <select id="symbol"><option>BTCUSDT</option><option>ETHUSDT</option></select>
          <select id="tf"><option>1m</option><option>5m</option><option>15m</option><option>1h</option></select>
          <button id="load">Load history</button>
          <button id="ping">Ping API</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div style="font-weight:600;margin-bottom:8px">Chart</div>
      <div id="chart"></div>
    </div>

    <div class="card">
      <div style="font-weight:600;margin-bottom:8px">Backtest</div>
      <div class="grid">
        <div class="col2"><label>From<br><input id="from" type="datetime-local"></label></div>
        <div class="col2"><label>To<br><input id="to" type="datetime-local"></label></div>
        <div><label>Equity<br><input id="eq" type="number" value="10000"></label></div>
        <div><label>Lev<br><input id="lev" type="number" step="1" value="1"></label></div>
        <div><label>Strategy<br>
          <select id="strat"><option value="ema_atr">EMA+ATR</option><option value="rsi">RSI</option></select>
        </label></div>
        <div class="col3"><label>Args (JSON)<br><input id="args" class="mono" value='{"fast":9,"slow":21,"atr":14,"R":1.5}'></label></div>
        <div class="col3"><label>Fees (bps)<br><input id="fees" class="mono" value='{"makerBps":2,"takerBps":5}'></label></div>
      </div>
      <div class="row" style="margin-top:8px">
        <button id="run">Run backtest</button>
        <div id="sum" class="mono muted"></div>
        <a id="zip" href="#" download style="display:none;margin-left:auto">Download ZIP</a>
      </div>
    </div>

    <div class="card">
      <div style="font-weight:600;margin-bottom:8px">Live stream (SSE)</div>
      <pre id="stream" class="mono" style="white-space:pre-wrap"></pre>
    </div>
  </div>
<script src="/ui/app.js"></script>
</body>
</html>

